#include <stdlib.h>
#include <libft.h>
#include <string.h>

/* check behavior when c = '\0' */

/* counts the number of occurrences of c in s
 */

static int countsplits(char const *s, char c)
{
	int count;
	count = 0;
	if (s)
		while (*s != '\0')
		{
			while (*s && *s == c)
				s++;
			if (*s && *s != c)
			{
				printf("%s\n", s);
				while (*s && *s != c)
					s++;
				count++;
			}
		}
	return (count);
}

char **ft_split_dev(char const *s, char c)
{
	char	**arr;
	char	*ptr_s;
	int		next_c;
	int		nth_split;
	int		splits;

	printf("\n---[%s] split by [%c] len:%d\n", s, c, ft_strlen(s));
	ptr_s = (char *)s;
	nth_split = 0;
	if (!s)
		return (0);
	splits = countsplits(s, c) ;
	printf("Splitting into %d parts.\n", splits);
	arr = malloc(splits * sizeof(char *));
	if (!arr)
		return 0;
	while (nth_split < splits)
	{
		printf("1: enter while loop\n");
		while (*ptr_s && *ptr_s == c)
			ptr_s++;
		printf("2: moving the pointer to non C\n");
		next_c = 0;
		while (ptr_s[next_c] && ptr_s[next_c] != c)
			next_c++;
		printf("3: found the next character at %d\n", next_c);
		arr[nth_split] = malloc(next_c + 1);
		if (!arr[nth_split])
			return (0);
		printf("4: create malloc of length %d\n", next_c + 1);
		// initially wrote ptr_s = memccpy(...), but it was returning a null pointer. :(
		memccpy(arr[nth_split], ptr_s, (int)c, next_c);
		printf("5: copied [%s]\n", ptr_s);
		ptr_s = ptr_s + next_c;
		printf("6: leftover string [%s]\n", ptr_s);
		arr[nth_split][next_c] = '\0';
		printf("7: copied over [%s]\n", arr[nth_split]);
		nth_split++;
		printf("nthsplits:%d/%d\n", nth_split, splits);
	}
	return (arr);
}

